{% extends 'base.html' %}


{% block title %} Swap {% endblock %}


{% block body %}
<html>
<head>
<title>Swap Book</title>
        <!-- Link allow you to use python with HTML -->
        <link rel="stylesheet" href="https://pyscript.net/alpha/pyscript.css" />
        <script defer src="https://pyscript.net/alpha/pyscript.js"></script> 
        
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">

<style>
    .container {
        background-color: black;
        color: white;
    }
</style>
</head>
<body>

    <!-- Header -->
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet"/>
    <div class="jumbotron">
        <div class="container">
            <div class="row d-flex justify-content-center">
                <div class="col-xs-3">
                    <img class="img-responsive" src="logo.jpeg" alt="Book Logo">
                </div>
                <div class="col-xs-7">
                    <h1>The Reading Circle</h1>
                    <p>Experience the joy of reading with The Reading Circle - where every book is a new adventure!</p>
                </div>
            </div>
        </div>
    </div>

    <script>
  // function updateTime() {
  //   const timer = document.getElementById("timer");
  //   const enableButton = document.getElementById("enableButton");
  //   const container = document.querySelector(".w3-container");

  //   // Set the end date to 30 days from now
  //   const endDate = new Date();
  //   endDate.setDate(endDate.getDate() + 0);

  //   // Calculate the remaining time in milliseconds
  //   const remainingTime = endDate.getTime() - new Date().getTime();

  //   // Convert remaining time to days, hours, minutes, and seconds
  //   let remainingSeconds = Math.ceil(remainingTime / 1000);
  //   const remainingMinutes = Math.floor(remainingSeconds / 60);
  //   const remainingHours = Math.floor(remainingMinutes / 60);
  //   const remainingDays = Math.floor(remainingHours / 24);

  //   // Calculate the remaining time as a string
  //   const remainingTimeString = `${remainingDays}d ${remainingHours % 24}h ${remainingMinutes % 60}m ${remainingSeconds % 60}s`;

  //   // Update the timer element with the remaining time
  //   timer.innerHTML = remainingTimeString;

  //   // Change background color of the container based on remaining time
  //   if (remainingDays <= 10) {
  //     container.style.backgroundColor = "red";
  //   } else if (remainingDays <= 20) {
  //     container.style.backgroundColor = "yellow";
  //   } else {
  //     container.style.backgroundColor = "green";
  //   }

  //   // Enable the button after 30 days
  //   if (remainingTime <= 0) {
  //     enableButton.textContent = "SWAP";
  //     enableButton.disabled = false;
  //   }

  //   // Display countdown of hours, minutes, and seconds
  //   // const hoursString = `${remainingHours.toString().padStart(2, "0")}:`;
  //   const minutesString = `${(remainingMinutes % 60).toString().padStart(2, "0")}:`;
  //   const secondsString = `${(remainingSeconds % 60).toString().padStart(2, "0")}`;
  //   timer.innerHTML = `${hoursString}${minutesString}${secondsString} (${remainingTimeString})`;
  // }

  // // Call the updateTime function every second
  // setInterval(updateTime, 100);

  function updateTime() {
  const timer = document.getElementById("timer");
  const enableButton = document.getElementById("enableButton");
  const container = document.querySelector(".w3-container");

  // Set the end date to 30 days from now
  const endDate = new Date();
  endDate.setDate(endDate.getDate() + 30);

  // Calculate the remaining time in milliseconds
  const remainingTime = endDate.getTime() - new Date().getTime();

  // Convert remaining time to days, hours, minutes, and seconds
  let remainingSeconds = Math.ceil(remainingTime / 1000);
  const remainingMinutes = Math.floor(remainingSeconds / 60);
  const remainingHours = Math.floor(remainingMinutes / 60);
  const remainingDays = Math.floor(remainingHours / 24);

  // Calculate the remaining time as a string
  const remainingTimeString = `${remainingDays}d ${remainingHours % 24}h ${remainingMinutes % 60}m ${remainingSeconds % 60}s`;

  // Update the timer element with the remaining time
  timer.innerHTML = remainingTimeString;

  // Change background color of the container based on remaining time
  if (remainingDays <= 5) {
    container.style.backgroundColor = "red";
  } else if (remainingDays <= 10) {
    container.style.backgroundColor = "yellow";
  } else {
    container.style.backgroundColor = "green";
  }

  // Enable the button after 30 days
  if (remainingTime <= 0) {
    enableButton.textContent = "SWAP";
    enableButton.disabled = false;
  }

  // Display countdown of hours, minutes, and seconds
  const minutesString = `${(remainingMinutes % 60).toString().padStart(2, "0")}:`;
  const secondsString = `${(remainingSeconds % 60).toString().padStart(2, "0")}`;
  timer.innerHTML = `${hoursString}${minutesString}${secondsString}`;

  // Stop the timer when remaining time reaches 0
  if (remainingTime <= 0) {
    clearInterval(intervalId);
    timer.innerHTML = `00:00:00 (0d 0h 0m 0s)`;
  }

  remainingSeconds--;
}

// Call the updateTime function every second
const intervalId = setInterval(updateTime, 1000);

    </script>
    
    <!-- Info text -->
    <div class="w3-row-padding w3-content" style="max-width:1400px">
      <div class="w3-twothird">
        <!-- Timer bar -->
          <div class="w3-row-padding w3-content" style="max-width:1400px">
            <div class="w3-container w3-animate-zoom w3-left-align">
              <div style="display: flex; justify-content: space-between; align-items: center;">
                <h3>Time remaining: <span id="timer"></span></h3>
                <button class="btn btn-primary" id="enableButton" disabled>Enable after 30 days</button>
              </div>
            </div>
          </div>
        <table class="table table-success table-striped table-hover" border="1">
          <thead>
              <tr>
                  <!-- <th>ID</th> -->
                  <th>Title</th>
                  <th>Author</th>
                  <th>Category</th>
                  <th>Image link</th>
                   <th colspan="1">Actions</th>
              </tr>
          </thead>
          <tbody>
              {% for book in books %}
    
                   {% if book.userid == session.id %}
                  <tr>
                      <!-- <td>{{book.id}}</td> -->
                      <td>{{book.title}}</td>
                      <td>{{book.author}}</td>
                      <td>{{book.category}}</td>
                      <td>{{book.image_link}}</td>
                      <td>
                         <a href="/update/{{book.id}}" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#modaledit{{book.id}}">Update</a>    
                      </td>
                  </tr>
              {% endif %}
          {% endfor %}
          </tbody>
        </table>
      </div>
      <div class="w3-third">
        <div class="w3-container w3-light-grey">
            <h2>Our Mission:</h2>
          <p>At Random Swap, we believe that reading should be a shared experience. By connecting book lovers around the world, we hope to promote the joy of reading and help users discover new authors and genres. We're committed to creating a safe, welcoming community where users can share their love of books and connect with like-minded individuals.</p>
          <p class="w3-justify"></p>
        </div>
        <br>
        <div class="w3-container w3-light-grey w3-justify">
            <h2>About:</h2>
            <p>Welcome to Random Swap, the platform that brings book lovers together for unexpected discoveries and swaps! With Random Swap, you never know what book you'll get next, but you can be sure that every swap is an opportunity to connect with other book lovers and discover new worlds.</p>
          <p class="w3-justify"></p>
        </div>
        <br>
        <div class="w3-container w3-light-grey w3-justify">
            <h2>How it works:</h2>
            <p>In Random Swap, members share books with each other. When you receive a book and finish reading it, the club wil know that you have read so you won't recieve the same book again. Please note that there is a one-month time limit to read each book.</p>
            <p class="w3-justify"></p>
        </div>
      </div>
    </div>
    
</body>
</html>

{% endblock %}